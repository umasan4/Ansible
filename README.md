### メモ

フォーマット整理(カレントディレクトリ以下を再帰的に整理)
terraform fmt -recursive

---
## 疎通確認
- natとtarget instanceを作成後に、targetからnatを経由して外部に出られるかを確認する手順
ターゲットノード（Private Subnet）からインターネットへ出る通信が、正しくNATインスタンスを経由しているか を確認する手順を案内します。

最も簡単で確実な AWS Systems Manager (SSM/セッションマネージャー) を使った方法で行います。

1. ターゲットノードへ接続する
SSH鍵を使わず、ブラウザから直接接続します。 （※前のコードで AmazonSSMManagedInstanceCore ポリシーをアタッチしているので繋がるはずです）

AWSマネジメントコンソールで [EC2] ダッシュボードを開く。

作成したターゲットノード（...-target-...）を選択。

画面右上の [接続 (Connect)] をクリック。

[セッションマネージャー] タブを選択し、[接続] ボタンをクリック。

※ボタンが押せない場合は、IAMロール設定か、起動から数分待つ必要があります。

2. インターネット接続確認（基本）
黒いコンソール画面が開いたら、まずは外に出られるか確認します。

Bash

# Googleへ通信確認
ping -c 3 google.com
成功: 応答（bytes from ...）があれば、インターネットへのルートは確保されています。

失敗: タイムアウトする場合、ルートテーブルかセキュリティグループの設定に問題があります。

3. NAT経由であることの証明（重要）
「インターネットに出られた」だけでは不十分です。「本当にNATインスタンスを通っているか（間違ってIGWから出ていないか）」を確認します。

以下のコマンドで、「Webサイト側から見たあなたのIPアドレス」 を表示させます。

Bash

# 自分のグローバルIPを確認
curl https://checkip.amazonaws.com